{% extends 'admins/layout.html' %}
{% load  commontags %}
{% load  admintags %}
{% block page_wrapper %}
  <div class="row">
    <div class="col-lg-12">
      <h1 class="page-header">Video Templates</h1>
    </div>
  </div>
  {% include 'common/partials/alert-message.html' %}
  <div class="row">
    <form class="col-sm-12 form-horizontal new-templates-form" action="/admins/video_templates/{{form.0.id}}/update" method="post"  enctype="multipart/form-data">
      {% csrf_token %}
      <input type="hidden" name="extra_variation_count" value="{{extra_variations_count}}"/>
      <a class="btn btn-primary add-new-variation">Add Variation</a>
      <div class="panel panel-info template-panel main-template-panel">
        <div class="panel-heading">
          Edit Main Variation
        </div>
        <div class="panel-body">
          <div class="form-group">
            <label class="col-sm-2 control-label required-in-variation">Title</label>
            <div class="col-sm-5">
              <input type="hidden" name="id" value="{{form.0.id}}" class="required-in-variation"/>
              <input type="text" name="title" placeholder="Title" class="form-control required-in-variation" value="{{ form.0.title }}"/>
              {% if flash_data.errors.title %}
                <span class="error">{{ flash_data.errors.title }}</span>
              {% endif %}
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-2 control-label">Category</label>
            <div class="col-sm-5">
              {% with template_categories=form.0|get_categoriy_ids_array %}
                <select name="categories[]" class="form-control" multiple=true>
                  {% for category in categories %}
                    <option value="{{ category.id }}" {% if category.id|in_array:template_categories %} selected {% endif %}>{{ category.title }}</option>
                  {% endfor %}
                </select>
              {% endwith %}
              {% if flash_data.errors.categories %}
                <span class="error">{{ flash_data.errors.categories }}</span>
              {% endif %}
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-2 control-label required-in-variation">Demo File</label>
            <div class="col-sm-5">
              <input type="file" name="demo_file" placeholder="Demo File" class="form-control required-in-variation"/>
              {% if flash_data.errors.demo_file %}
                <span class="error">{{ flash_data.errors.demo_file }}</span>
              {% endif %}
            </div>
          </div>
          <div class="form-group">
            <label class="col-sm-2 control-label required-in-variation">Project Compressed File</label>
            <div class="col-sm-5">
              <input type="file" name="project_compressed_file" placeholder="Project Compressed File" class="form-control required-in-variation"/>
              {% if flash_data.errors.project_compressed_file %}
                <span class="error">{{ flash_data.errors.project_compressed_file }}</span>
              {% endif %}
            </div>
          </div>
          <input type="hidden" name="variation_id" value="{{form.0.variation_id}}"/>
          <input type="hidden" name="main_variation" class="required-in-variation" value="{{form.0.main_variation}}"/>
          <div class="form-group">
            <label class="col-sm-2 control-label required-in-variation">Variation Description</label>
            <div class="col-sm-5">
              <textarea name="variation_description" class="form-control required-in-variation">{{form.0.variation_description}}</textarea>
              {% if flash_data.errors.variation_description %}
                <span class="error">{{ flash_data.errors.variation_description }}</span>
              {% endif %}
            </div>
          </div>
          <!-- </form> -->
        </div>
      </div>
      {% for variation in form|skip_first %}
        <div class="panel panel-info template-panel">
          <div class="panel-heading">
            Edit Variation {{ forloop.counter }}
          </div>
          <div class="panel-body">
            <div class="form-group">
              <label class="col-sm-2 control-label required-in-variation">Title</label>
              <div class="col-sm-5">
                <input type="hidden" name="{{forloop.counter}}_id" value="{{variation.id}}" class="required-in-variation"/>
                <input type="text" name="{{forloop.counter}}_title" placeholder="Title" class="form-control required-in-variation" value="{{ variation.title }}"/>
                {% if flash_data.errors.title %}
                  <span class="error">{{ flash_data.errors.title }}</span>
                {% endif %}
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label required-in-variation">Demo File</label>
              <div class="col-sm-5">
                <input type="file" name="{{forloop.counter}}_demo_file" placeholder="Demo File" class="form-control required-in-variation"/>
                {% if flash_data.errors.demo_file %}
                  <span class="error">{{ flash_data.errors.demo_file }}</span>
                {% endif %}
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label required-in-variation">Project Compressed File</label>
              <div class="col-sm-5">
                <input type="file" name="{{forloop.counter}}_project_compressed_file" placeholder="Project Compressed File" class="form-control required-in-variation"/>
                {% if flash_data.errors.project_compressed_file %}
                  <span class="error">{{ flash_data.errors.project_compressed_file }}</span>
                {% endif %}
              </div>
            </div>
            <input type="hidden" name="{{forloop.counter}}_main_variation" class="required-in-variation" value="{{variation.main_variation}}"/>
            <div class="form-group">
              <label class="col-sm-2 control-label required-in-variation">Variation Description</label>
              <div class="col-sm-5">
                <textarea name="{{forloop.counter}}_variation_description" class="form-control required-in-variation">{{variation.variation_description}}</textarea>
                {% if flash_data.errors.variation_description %}
                  <span class="error">{{ flash_data.errors.variation_description }}</span>
                {% endif %}
              </div>
            </div>
            <!-- </form> -->
          </div>
        </div>
      {% endfor %}
      <div class="row save-btn">
        <div class="col-ms-12">
          <div class="form-group">
            <div class="col-sm-12">
              <button type="submit" id="save-templates" class="btn btn-success pull-right" style="width:300px; margin-right: 14px;">Save</button>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
{% endblock %}